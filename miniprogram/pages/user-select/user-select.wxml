<!-- å…´è¶£é€‰æ‹©é¡µé¢æ¨¡æ¿ -->
<view class="container {{showContent ? 'fade-in' : ''}}">
  <!-- å¤´éƒ¨ä¿¡æ¯ -->
  <view class="header">
    <view class="user-info">
      <text class="user-name">{{userName}} çš„é€‰æ‹©</text>
      <text class="user-desc">é€‰æ‹©ä½ æ„Ÿå…´è¶£çš„æ´»åŠ¨ï¼Œä¸æ„Ÿå…´è¶£çš„ä¸ç”¨é€‰æ‹©ã€‚é€‰æ‹©åå¯ä»¥è®¾ç½®é‡è¦ç¨‹åº¦ï¼ˆ1-5æ˜Ÿï¼‰ï¼Œè¶Šå–œæ¬¢è¶Šé‡è¦å°±ç»™è¶Šé«˜åˆ†ã€‚</text>
    </view>
    <view class="header-actions">
      <button class="btn btn-secondary" bindtap="goHome" size="mini">
        <text class="btn-icon">ğŸ </text>
        è¿”å›é¦–é¡µ
      </button>
    </view>
  </view>

  <!-- åˆ‡æ¢æŒ‰é’® -->
  <view class="toggle-section">
    <button 
      class="toggle-btn {{showConstellation ? 'active' : ''}}"
      bindtap="toggleConstellation"
    >
      <text class="toggle-icon">â­</text>
      æ˜Ÿç©ºå›¾æ¨¡å¼
    </button>
    <button 
      class="toggle-btn {{!showConstellation ? 'active' : ''}}"
      bindtap="toggleConstellation"
    >
      <text class="toggle-icon">ğŸ“‹</text>
      åˆ—è¡¨æ¨¡å¼
    </button>
  </view>

  <!-- æ˜Ÿç©ºå›¾æ¨¡å¼ -->
  <view wx:if="{{showConstellation}}" class="constellation-section">
    <constellation 
      interests="{{getCurrentCategoryInterests()}}"
      selected-interests="{{selectedInterests}}"
      bindinterestselect="handleInterestSelect"
    />
  </view>

  <!-- åˆ—è¡¨æ¨¡å¼ -->
  <view wx:else class="list-section">
    <!-- åˆ†ç±»æ ‡ç­¾ -->
    <view class="category-tabs">
      <view 
        wx:for="{{interestCategories}}"
        wx:key="id"
        class="category-tab {{activeCategory === item.id ? 'active' : ''}}"
        data-category="{{item.id}}"
        bindtap="switchCategory"
      >
        <text class="category-icon">{{item.icon}}</text>
        <text class="category-name">{{item.name}}</text>
      </view>
    </view>

    <!-- å…´è¶£ç½‘æ ¼ -->
    <view class="interests-grid">
      <view 
        wx:for="{{getCurrentCategoryInterests()}}"
        wx:key="id"
        class="interest-item {{isSelected(item.id) ? 'selected' : ''}}"
        bindtap="handleInterestClick"
        data-interest="{{item}}"
      >
        <view class="interest-content">
          <view class="interest-header">
            <text class="interest-icon">{{item.icon}}</text>
            <text class="interest-name">{{item.name}}</text>
            <text wx:if="{{isSelected(item.id)}}" class="selected-icon">âœ“</text>
          </view>
          
          <!-- é‡è¦ç¨‹åº¦é€‰æ‹© -->
          <view wx:if="{{isSelected(item.id)}}" class="importance-section">
            <text class="importance-label">é‡è¦ç¨‹åº¦</text>
            <view class="importance-stars">
              <view 
                wx:for="{{[1, 2, 3, 4, 5]}}"
                wx:key="*this"
                class="star {{getSelectedInterest(item.id).importance >= item ? 'active' : ''}}"
                data-interest-id="{{item.id}}"
                data-importance="{{item}}"
                bindtap="updateInterestImportance"
              >
                â­
              </view>
            </view>
            <text class="importance-value">{{getSelectedInterest(item.id).importance}}â˜…</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å·²é€‰æ‹©çš„å…´è¶£é¢„è§ˆ -->
  <view class="selected-preview">
    <view class="preview-header">
      <text class="preview-title">å·²é€‰æ‹©çš„å…´è¶£ ({{selectedInterests.length}})</text>
    </view>
    <view wx:if="{{selectedInterests.length > 0}}" class="selected-list">
      <view 
        wx:for="{{selectedInterests}}"
        wx:key="id"
        class="selected-item"
      >
        <text class="selected-icon">{{item.icon}}</text>
        <text class="selected-name">{{item.name}}</text>
        <text class="selected-importance">{{item.importance}}â˜…</text>
      </view>
    </view>
    <view wx:else class="empty-state">
      <text class="empty-icon">ğŸŒŸ</text>
      <text class="empty-text">è¿˜æ²¡æœ‰é€‰æ‹©ä»»ä½•å…´è¶£</text>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
  <view class="bottom-actions">
    <button 
      class="btn btn-primary btn-large {{isLoading ? 'loading' : ''}}"
      bindtap="completeSelection"
      disabled="{{selectedInterests.length === 0 || isLoading}}"
    >
      <text wx:if="{{!isLoading}}" class="btn-text">
        {{isUser1 ? 'å®Œæˆé€‰æ‹©ï¼Œåˆ†äº«ç»™å¯¹æ–¹' : 'æŸ¥çœ‹åŒ¹é…ç»“æœ'}}
      </text>
      <view wx:else class="loading-spinner"></view>
    </button>
  </view>
</view>